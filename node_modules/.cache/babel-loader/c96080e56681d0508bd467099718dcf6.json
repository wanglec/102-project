{"ast":null,"code":"import React, { forwardRef, useRef, useState, useEffect, useMemo, useLayoutEffect, useCallback, useImperativeHandle } from 'react';\nimport { omit } from 'jerrypick';\nimport fromEntries from 'fromentries';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction index(kapsuleComponent, comboParam) {\n  var _ref = _typeof(comboParam) === 'object' ? comboParam : {\n    // support old schema for backwards compatibility\n    wrapperElementType: comboParam,\n    methodNames: (arguments.length <= 2 ? undefined : arguments[2]) || undefined,\n    initPropNames: (arguments.length <= 3 ? undefined : arguments[3]) || undefined\n  },\n      _ref$wrapperElementTy = _ref.wrapperElementType,\n      wrapperElementType = _ref$wrapperElementTy === void 0 ? 'div' : _ref$wrapperElementTy,\n      _ref$nodeMapper = _ref.nodeMapper,\n      nodeMapper = _ref$nodeMapper === void 0 ? function (node) {\n    return node;\n  } : _ref$nodeMapper,\n      _ref$methodNames = _ref.methodNames,\n      methodNames = _ref$methodNames === void 0 ? [] : _ref$methodNames,\n      _ref$initPropNames = _ref.initPropNames,\n      initPropNames = _ref$initPropNames === void 0 ? [] : _ref$initPropNames;\n\n  return /*#__PURE__*/forwardRef(function (props, ref) {\n    var domEl = useRef();\n\n    var _useState = useState({}),\n        _useState2 = _slicedToArray(_useState, 2),\n        prevProps = _useState2[0],\n        setPrevProps = _useState2[1];\n\n    useEffect(function () {\n      return setPrevProps(props);\n    }); // remember previous props\n    // instantiate the inner kapsule component with the defined initPropNames\n\n    var comp = useMemo(function () {\n      var configOptions = fromEntries(initPropNames.filter(function (p) {\n        return props.hasOwnProperty(p);\n      }).map(function (prop) {\n        return [prop, props[prop]];\n      }));\n      return kapsuleComponent(configOptions);\n    }, []);\n    useLayoutEffect(function () {\n      comp(nodeMapper(domEl.current)); // mount kapsule synchronously on this element ref, optionally mapped into an object that the kapsule understands\n    }, []);\n    useEffect(function () {\n      // invoke destructor on unmount, if it exists\n      return comp._destructor instanceof Function ? comp._destructor : undefined;\n    }, []); // Call a component method\n\n    var _call = useCallback(function (method) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return comp[method] instanceof Function ? comp[method].apply(comp, args) : undefined;\n    } // method not found\n    , [comp]); // propagate component props that have changed\n\n\n    var dynamicProps = omit(props, [].concat(_toConsumableArray(methodNames), _toConsumableArray(initPropNames))); // initPropNames or methodNames should not be called\n\n    Object.keys(dynamicProps).filter(function (p) {\n      return prevProps[p] !== props[p];\n    }).forEach(function (p) {\n      return _call(p, props[p]);\n    }); // bind external methods to parent ref\n\n    useImperativeHandle(ref, function () {\n      return fromEntries(methodNames.map(function (method) {\n        return [method, function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          return _call.apply(void 0, [method].concat(args));\n        }];\n      }));\n    });\n    return /*#__PURE__*/React.createElement(wrapperElementType, {\n      ref: domEl\n    });\n  });\n}\n\nexport default index;","map":{"version":3,"sources":["/Users/lechuanwang/Documents/2021 spring/dsc106/project/dsc102/102-project/node_modules/react-kapsule/dist/react-kapsule.module.js"],"names":["React","forwardRef","useRef","useState","useEffect","useMemo","useLayoutEffect","useCallback","useImperativeHandle","omit","fromEntries","_typeof","obj","Symbol","iterator","constructor","prototype","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","from","_i","_arr","_n","_d","_s","_e","call","next","done","push","value","length","err","o","minLen","n","Object","toString","slice","name","test","len","arr2","TypeError","index","kapsuleComponent","comboParam","_ref","wrapperElementType","methodNames","arguments","undefined","initPropNames","_ref$wrapperElementTy","_ref$nodeMapper","nodeMapper","node","_ref$methodNames","_ref$initPropNames","props","ref","domEl","_useState","_useState2","prevProps","setPrevProps","comp","configOptions","filter","p","hasOwnProperty","map","prop","current","_destructor","Function","_call","method","_len","args","_key","apply","dynamicProps","concat","keys","forEach","_len2","_key2","createElement"],"mappings":"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","sourcesContent":["import React, { forwardRef, useRef, useState, useEffect, useMemo, useLayoutEffect, useCallback, useImperativeHandle } from 'react';\nimport { omit } from 'jerrypick';\nimport fromEntries from 'fromentries';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction index (kapsuleComponent, comboParam) {\n  var _ref = _typeof(comboParam) === 'object' ? comboParam : {\n    // support old schema for backwards compatibility\n    wrapperElementType: comboParam,\n    methodNames: (arguments.length <= 2 ? undefined : arguments[2]) || undefined,\n    initPropNames: (arguments.length <= 3 ? undefined : arguments[3]) || undefined\n  },\n      _ref$wrapperElementTy = _ref.wrapperElementType,\n      wrapperElementType = _ref$wrapperElementTy === void 0 ? 'div' : _ref$wrapperElementTy,\n      _ref$nodeMapper = _ref.nodeMapper,\n      nodeMapper = _ref$nodeMapper === void 0 ? function (node) {\n    return node;\n  } : _ref$nodeMapper,\n      _ref$methodNames = _ref.methodNames,\n      methodNames = _ref$methodNames === void 0 ? [] : _ref$methodNames,\n      _ref$initPropNames = _ref.initPropNames,\n      initPropNames = _ref$initPropNames === void 0 ? [] : _ref$initPropNames;\n\n  return /*#__PURE__*/forwardRef(function (props, ref) {\n    var domEl = useRef();\n\n    var _useState = useState({}),\n        _useState2 = _slicedToArray(_useState, 2),\n        prevProps = _useState2[0],\n        setPrevProps = _useState2[1];\n\n    useEffect(function () {\n      return setPrevProps(props);\n    }); // remember previous props\n    // instantiate the inner kapsule component with the defined initPropNames\n\n    var comp = useMemo(function () {\n      var configOptions = fromEntries(initPropNames.filter(function (p) {\n        return props.hasOwnProperty(p);\n      }).map(function (prop) {\n        return [prop, props[prop]];\n      }));\n      return kapsuleComponent(configOptions);\n    }, []);\n    useLayoutEffect(function () {\n      comp(nodeMapper(domEl.current)); // mount kapsule synchronously on this element ref, optionally mapped into an object that the kapsule understands\n    }, []);\n    useEffect(function () {\n      // invoke destructor on unmount, if it exists\n      return comp._destructor instanceof Function ? comp._destructor : undefined;\n    }, []); // Call a component method\n\n    var _call = useCallback(function (method) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return comp[method] instanceof Function ? comp[method].apply(comp, args) : undefined;\n    } // method not found\n    , [comp]); // propagate component props that have changed\n\n\n    var dynamicProps = omit(props, [].concat(_toConsumableArray(methodNames), _toConsumableArray(initPropNames))); // initPropNames or methodNames should not be called\n\n    Object.keys(dynamicProps).filter(function (p) {\n      return prevProps[p] !== props[p];\n    }).forEach(function (p) {\n      return _call(p, props[p]);\n    }); // bind external methods to parent ref\n\n    useImperativeHandle(ref, function () {\n      return fromEntries(methodNames.map(function (method) {\n        return [method, function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          return _call.apply(void 0, [method].concat(args));\n        }];\n      }));\n    });\n    return /*#__PURE__*/React.createElement(wrapperElementType, {\n      ref: domEl\n    });\n  });\n}\n\nexport default index;\n"]},"metadata":{},"sourceType":"module"}