{"ast":null,"code":"import _classCallCheck from \"/Users/lechuanwang/Documents/2021 spring/dsc106/project/dsc102/102-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _assertThisInitialized from \"/Users/lechuanwang/Documents/2021 spring/dsc106/project/dsc102/102-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/lechuanwang/Documents/2021 spring/dsc106/project/dsc102/102-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/lechuanwang/Documents/2021 spring/dsc106/project/dsc102/102-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { EventDispatcher, MOUSE, Quaternion, Vector2, Vector3 } from 'three';\nvar _changeEvent = {\n  type: 'change'\n};\nvar _startEvent = {\n  type: 'start'\n};\nvar _endEvent = {\n  type: 'end'\n};\n\nvar TrackballControls = /*#__PURE__*/function (_EventDispatcher) {\n  _inherits(TrackballControls, _EventDispatcher);\n\n  var _super = _createSuper(TrackballControls);\n\n  function TrackballControls(object, domElement) {\n    var _this;\n\n    _classCallCheck(this, TrackballControls);\n\n    _this = _super.call(this);\n    if (domElement === undefined) console.warn('THREE.TrackballControls: The second parameter \"domElement\" is now mandatory.');\n    if (domElement === document) console.error('THREE.TrackballControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.');\n\n    var scope = _assertThisInitialized(_this);\n\n    var STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      ZOOM: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_ZOOM_PAN: 4\n    };\n    _this.object = object;\n    _this.domElement = domElement; // API\n\n    _this.enabled = true;\n    _this.screen = {\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    };\n    _this.rotateSpeed = 1.0;\n    _this.zoomSpeed = 1.2;\n    _this.panSpeed = 0.3;\n    _this.noRotate = false;\n    _this.noZoom = false;\n    _this.noPan = false;\n    _this.staticMoving = false;\n    _this.dynamicDampingFactor = 0.2;\n    _this.minDistance = 0;\n    _this.maxDistance = Infinity;\n    _this.keys = ['KeyA'\n    /*A*/\n    , 'KeyS'\n    /*S*/\n    , 'KeyD'\n    /*D*/\n    ];\n    _this.mouseButtons = {\n      LEFT: MOUSE.ROTATE,\n      MIDDLE: MOUSE.DOLLY,\n      RIGHT: MOUSE.PAN\n    }; // internals\n\n    _this.target = new Vector3();\n    var EPS = 0.000001;\n    var lastPosition = new Vector3();\n    var lastZoom = 1;\n    var _state = STATE.NONE,\n        _keyState = STATE.NONE,\n        _touchZoomDistanceStart = 0,\n        _touchZoomDistanceEnd = 0,\n        _lastAngle = 0;\n\n    var _eye = new Vector3(),\n        _movePrev = new Vector2(),\n        _moveCurr = new Vector2(),\n        _lastAxis = new Vector3(),\n        _zoomStart = new Vector2(),\n        _zoomEnd = new Vector2(),\n        _panStart = new Vector2(),\n        _panEnd = new Vector2(); // for reset\n\n\n    _this.target0 = _this.target.clone();\n    _this.position0 = _this.object.position.clone();\n    _this.up0 = _this.object.up.clone();\n    _this.zoom0 = _this.object.zoom; // methods\n\n    _this.handleResize = function () {\n      var box = scope.domElement.getBoundingClientRect(); // adjustments come from similar code in the jquery offset() function\n\n      var d = scope.domElement.ownerDocument.documentElement;\n      scope.screen.left = box.left + window.pageXOffset - d.clientLeft;\n      scope.screen.top = box.top + window.pageYOffset - d.clientTop;\n      scope.screen.width = box.width;\n      scope.screen.height = box.height;\n    };\n\n    var getMouseOnScreen = function () {\n      var vector = new Vector2();\n      return function getMouseOnScreen(pageX, pageY) {\n        vector.set((pageX - scope.screen.left) / scope.screen.width, (pageY - scope.screen.top) / scope.screen.height);\n        return vector;\n      };\n    }();\n\n    var getMouseOnCircle = function () {\n      var vector = new Vector2();\n      return function getMouseOnCircle(pageX, pageY) {\n        vector.set((pageX - scope.screen.width * 0.5 - scope.screen.left) / (scope.screen.width * 0.5), (scope.screen.height + 2 * (scope.screen.top - pageY)) / scope.screen.width // screen.width intentional\n        );\n        return vector;\n      };\n    }();\n\n    _this.rotateCamera = function () {\n      var axis = new Vector3(),\n          quaternion = new Quaternion(),\n          eyeDirection = new Vector3(),\n          objectUpDirection = new Vector3(),\n          objectSidewaysDirection = new Vector3(),\n          moveDirection = new Vector3();\n      return function rotateCamera() {\n        moveDirection.set(_moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0);\n        var angle = moveDirection.length();\n\n        if (angle) {\n          _eye.copy(scope.object.position).sub(scope.target);\n\n          eyeDirection.copy(_eye).normalize();\n          objectUpDirection.copy(scope.object.up).normalize();\n          objectSidewaysDirection.crossVectors(objectUpDirection, eyeDirection).normalize();\n          objectUpDirection.setLength(_moveCurr.y - _movePrev.y);\n          objectSidewaysDirection.setLength(_moveCurr.x - _movePrev.x);\n          moveDirection.copy(objectUpDirection.add(objectSidewaysDirection));\n          axis.crossVectors(moveDirection, _eye).normalize();\n          angle *= scope.rotateSpeed;\n          quaternion.setFromAxisAngle(axis, angle);\n\n          _eye.applyQuaternion(quaternion);\n\n          scope.object.up.applyQuaternion(quaternion);\n\n          _lastAxis.copy(axis);\n\n          _lastAngle = angle;\n        } else if (!scope.staticMoving && _lastAngle) {\n          _lastAngle *= Math.sqrt(1.0 - scope.dynamicDampingFactor);\n\n          _eye.copy(scope.object.position).sub(scope.target);\n\n          quaternion.setFromAxisAngle(_lastAxis, _lastAngle);\n\n          _eye.applyQuaternion(quaternion);\n\n          scope.object.up.applyQuaternion(quaternion);\n        }\n\n        _movePrev.copy(_moveCurr);\n      };\n    }();\n\n    _this.zoomCamera = function () {\n      var factor;\n\n      if (_state === STATE.TOUCH_ZOOM_PAN) {\n        factor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\n        _touchZoomDistanceStart = _touchZoomDistanceEnd;\n\n        if (scope.object.isPerspectiveCamera) {\n          _eye.multiplyScalar(factor);\n        } else if (scope.object.isOrthographicCamera) {\n          scope.object.zoom *= factor;\n          scope.object.updateProjectionMatrix();\n        } else {\n          console.warn('THREE.TrackballControls: Unsupported camera type');\n        }\n      } else {\n        factor = 1.0 + (_zoomEnd.y - _zoomStart.y) * scope.zoomSpeed;\n\n        if (factor !== 1.0 && factor > 0.0) {\n          if (scope.object.isPerspectiveCamera) {\n            _eye.multiplyScalar(factor);\n          } else if (scope.object.isOrthographicCamera) {\n            scope.object.zoom /= factor;\n            scope.object.updateProjectionMatrix();\n          } else {\n            console.warn('THREE.TrackballControls: Unsupported camera type');\n          }\n        }\n\n        if (scope.staticMoving) {\n          _zoomStart.copy(_zoomEnd);\n        } else {\n          _zoomStart.y += (_zoomEnd.y - _zoomStart.y) * this.dynamicDampingFactor;\n        }\n      }\n    };\n\n    _this.panCamera = function () {\n      var mouseChange = new Vector2(),\n          objectUp = new Vector3(),\n          pan = new Vector3();\n      return function panCamera() {\n        mouseChange.copy(_panEnd).sub(_panStart);\n\n        if (mouseChange.lengthSq()) {\n          if (scope.object.isOrthographicCamera) {\n            var scale_x = (scope.object.right - scope.object.left) / scope.object.zoom / scope.domElement.clientWidth;\n            var scale_y = (scope.object.top - scope.object.bottom) / scope.object.zoom / scope.domElement.clientWidth;\n            mouseChange.x *= scale_x;\n            mouseChange.y *= scale_y;\n          }\n\n          mouseChange.multiplyScalar(_eye.length() * scope.panSpeed);\n          pan.copy(_eye).cross(scope.object.up).setLength(mouseChange.x);\n          pan.add(objectUp.copy(scope.object.up).setLength(mouseChange.y));\n          scope.object.position.add(pan);\n          scope.target.add(pan);\n\n          if (scope.staticMoving) {\n            _panStart.copy(_panEnd);\n          } else {\n            _panStart.add(mouseChange.subVectors(_panEnd, _panStart).multiplyScalar(scope.dynamicDampingFactor));\n          }\n        }\n      };\n    }();\n\n    _this.checkDistances = function () {\n      if (!scope.noZoom || !scope.noPan) {\n        if (_eye.lengthSq() > scope.maxDistance * scope.maxDistance) {\n          scope.object.position.addVectors(scope.target, _eye.setLength(scope.maxDistance));\n\n          _zoomStart.copy(_zoomEnd);\n        }\n\n        if (_eye.lengthSq() < scope.minDistance * scope.minDistance) {\n          scope.object.position.addVectors(scope.target, _eye.setLength(scope.minDistance));\n\n          _zoomStart.copy(_zoomEnd);\n        }\n      }\n    };\n\n    _this.update = function () {\n      _eye.subVectors(scope.object.position, scope.target);\n\n      if (!scope.noRotate) {\n        scope.rotateCamera();\n      }\n\n      if (!scope.noZoom) {\n        scope.zoomCamera();\n      }\n\n      if (!scope.noPan) {\n        scope.panCamera();\n      }\n\n      scope.object.position.addVectors(scope.target, _eye);\n\n      if (scope.object.isPerspectiveCamera) {\n        scope.checkDistances();\n        scope.object.lookAt(scope.target);\n\n        if (lastPosition.distanceToSquared(scope.object.position) > EPS) {\n          scope.dispatchEvent(_changeEvent);\n          lastPosition.copy(scope.object.position);\n        }\n      } else if (scope.object.isOrthographicCamera) {\n        scope.object.lookAt(scope.target);\n\n        if (lastPosition.distanceToSquared(scope.object.position) > EPS || lastZoom !== scope.object.zoom) {\n          scope.dispatchEvent(_changeEvent);\n          lastPosition.copy(scope.object.position);\n          lastZoom = scope.object.zoom;\n        }\n      } else {\n        console.warn('THREE.TrackballControls: Unsupported camera type');\n      }\n    };\n\n    _this.reset = function () {\n      _state = STATE.NONE;\n      _keyState = STATE.NONE;\n      scope.target.copy(scope.target0);\n      scope.object.position.copy(scope.position0);\n      scope.object.up.copy(scope.up0);\n      scope.object.zoom = scope.zoom0;\n      scope.object.updateProjectionMatrix();\n\n      _eye.subVectors(scope.object.position, scope.target);\n\n      scope.object.lookAt(scope.target);\n      scope.dispatchEvent(_changeEvent);\n      lastPosition.copy(scope.object.position);\n      lastZoom = scope.object.zoom;\n    }; // listeners\n\n\n    function onPointerDown(event) {\n      if (scope.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          onMouseDown(event);\n          break;\n        // TODO touch\n      }\n    }\n\n    function onPointerMove(event) {\n      if (scope.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          onMouseMove(event);\n          break;\n        // TODO touch\n      }\n    }\n\n    function onPointerUp(event) {\n      if (scope.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          onMouseUp(event);\n          break;\n        // TODO touch\n      }\n    }\n\n    function keydown(event) {\n      if (scope.enabled === false) return;\n      window.removeEventListener('keydown', keydown);\n\n      if (_keyState !== STATE.NONE) {\n        return;\n      } else if (event.code === scope.keys[STATE.ROTATE] && !scope.noRotate) {\n        _keyState = STATE.ROTATE;\n      } else if (event.code === scope.keys[STATE.ZOOM] && !scope.noZoom) {\n        _keyState = STATE.ZOOM;\n      } else if (event.code === scope.keys[STATE.PAN] && !scope.noPan) {\n        _keyState = STATE.PAN;\n      }\n    }\n\n    function keyup() {\n      if (scope.enabled === false) return;\n      _keyState = STATE.NONE;\n      window.addEventListener('keydown', keydown);\n    }\n\n    function onMouseDown(event) {\n      event.preventDefault();\n\n      if (_state === STATE.NONE) {\n        switch (event.button) {\n          case scope.mouseButtons.LEFT:\n            _state = STATE.ROTATE;\n            break;\n\n          case scope.mouseButtons.MIDDLE:\n            _state = STATE.ZOOM;\n            break;\n\n          case scope.mouseButtons.RIGHT:\n            _state = STATE.PAN;\n            break;\n\n          default:\n            _state = STATE.NONE;\n        }\n      }\n\n      var state = _keyState !== STATE.NONE ? _keyState : _state;\n\n      if (state === STATE.ROTATE && !scope.noRotate) {\n        _moveCurr.copy(getMouseOnCircle(event.pageX, event.pageY));\n\n        _movePrev.copy(_moveCurr);\n      } else if (state === STATE.ZOOM && !scope.noZoom) {\n        _zoomStart.copy(getMouseOnScreen(event.pageX, event.pageY));\n\n        _zoomEnd.copy(_zoomStart);\n      } else if (state === STATE.PAN && !scope.noPan) {\n        _panStart.copy(getMouseOnScreen(event.pageX, event.pageY));\n\n        _panEnd.copy(_panStart);\n      }\n\n      scope.domElement.ownerDocument.addEventListener('pointermove', onPointerMove);\n      scope.domElement.ownerDocument.addEventListener('pointerup', onPointerUp);\n      scope.dispatchEvent(_startEvent);\n    }\n\n    function onMouseMove(event) {\n      if (scope.enabled === false) return;\n      event.preventDefault();\n      var state = _keyState !== STATE.NONE ? _keyState : _state;\n\n      if (state === STATE.ROTATE && !scope.noRotate) {\n        _movePrev.copy(_moveCurr);\n\n        _moveCurr.copy(getMouseOnCircle(event.pageX, event.pageY));\n      } else if (state === STATE.ZOOM && !scope.noZoom) {\n        _zoomEnd.copy(getMouseOnScreen(event.pageX, event.pageY));\n      } else if (state === STATE.PAN && !scope.noPan) {\n        _panEnd.copy(getMouseOnScreen(event.pageX, event.pageY));\n      }\n    }\n\n    function onMouseUp(event) {\n      if (scope.enabled === false) return;\n      event.preventDefault();\n      _state = STATE.NONE;\n      scope.domElement.ownerDocument.removeEventListener('pointermove', onPointerMove);\n      scope.domElement.ownerDocument.removeEventListener('pointerup', onPointerUp);\n      scope.dispatchEvent(_endEvent);\n    }\n\n    function mousewheel(event) {\n      if (scope.enabled === false) return;\n      if (scope.noZoom === true) return;\n      event.preventDefault();\n\n      switch (event.deltaMode) {\n        case 2:\n          // Zoom in pages\n          _zoomStart.y -= event.deltaY * 0.025;\n          break;\n\n        case 1:\n          // Zoom in lines\n          _zoomStart.y -= event.deltaY * 0.01;\n          break;\n\n        default:\n          // undefined, 0, assume pixels\n          _zoomStart.y -= event.deltaY * 0.00025;\n          break;\n      }\n\n      scope.dispatchEvent(_startEvent);\n      scope.dispatchEvent(_endEvent);\n    }\n\n    function touchstart(event) {\n      if (scope.enabled === false) return;\n      event.preventDefault();\n\n      switch (event.touches.length) {\n        case 1:\n          _state = STATE.TOUCH_ROTATE;\n\n          _moveCurr.copy(getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          _movePrev.copy(_moveCurr);\n\n          break;\n\n        default:\n          // 2 or more\n          _state = STATE.TOUCH_ZOOM_PAN;\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\n          _touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt(dx * dx + dy * dy);\n          var x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n          var y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n\n          _panStart.copy(getMouseOnScreen(x, y));\n\n          _panEnd.copy(_panStart);\n\n          break;\n      }\n\n      scope.dispatchEvent(_startEvent);\n    }\n\n    function touchmove(event) {\n      if (scope.enabled === false) return;\n      event.preventDefault();\n\n      switch (event.touches.length) {\n        case 1:\n          _movePrev.copy(_moveCurr);\n\n          _moveCurr.copy(getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          break;\n\n        default:\n          // 2 or more\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\n          _touchZoomDistanceEnd = Math.sqrt(dx * dx + dy * dy);\n          var x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n          var y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n\n          _panEnd.copy(getMouseOnScreen(x, y));\n\n          break;\n      }\n    }\n\n    function touchend(event) {\n      if (scope.enabled === false) return;\n\n      switch (event.touches.length) {\n        case 0:\n          _state = STATE.NONE;\n          break;\n\n        case 1:\n          _state = STATE.TOUCH_ROTATE;\n\n          _moveCurr.copy(getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          _movePrev.copy(_moveCurr);\n\n          break;\n      }\n\n      scope.dispatchEvent(_endEvent);\n    }\n\n    function contextmenu(event) {\n      if (scope.enabled === false) return;\n      event.preventDefault();\n    }\n\n    _this.dispose = function () {\n      scope.domElement.removeEventListener('contextmenu', contextmenu);\n      scope.domElement.removeEventListener('pointerdown', onPointerDown);\n      scope.domElement.removeEventListener('wheel', mousewheel);\n      scope.domElement.removeEventListener('touchstart', touchstart);\n      scope.domElement.removeEventListener('touchend', touchend);\n      scope.domElement.removeEventListener('touchmove', touchmove);\n      scope.domElement.ownerDocument.removeEventListener('pointermove', onPointerMove);\n      scope.domElement.ownerDocument.removeEventListener('pointerup', onPointerUp);\n      window.removeEventListener('keydown', keydown);\n      window.removeEventListener('keyup', keyup);\n    };\n\n    _this.domElement.addEventListener('contextmenu', contextmenu);\n\n    _this.domElement.addEventListener('pointerdown', onPointerDown);\n\n    _this.domElement.addEventListener('wheel', mousewheel, {\n      passive: false\n    });\n\n    _this.domElement.addEventListener('touchstart', touchstart, {\n      passive: false\n    });\n\n    _this.domElement.addEventListener('touchend', touchend);\n\n    _this.domElement.addEventListener('touchmove', touchmove, {\n      passive: false\n    });\n\n    _this.domElement.ownerDocument.addEventListener('pointermove', onPointerMove);\n\n    _this.domElement.ownerDocument.addEventListener('pointerup', onPointerUp);\n\n    window.addEventListener('keydown', keydown);\n    window.addEventListener('keyup', keyup);\n\n    _this.handleResize(); // force an update at start\n\n\n    _this.update();\n\n    return _this;\n  }\n\n  return TrackballControls;\n}(EventDispatcher);\n\nexport { TrackballControls };","map":{"version":3,"sources":["/Users/lechuanwang/Documents/2021 spring/dsc106/project/dsc102/102-project/node_modules/three/examples/jsm/controls/TrackballControls.js"],"names":["EventDispatcher","MOUSE","Quaternion","Vector2","Vector3","_changeEvent","type","_startEvent","_endEvent","TrackballControls","object","domElement","undefined","console","warn","document","error","scope","STATE","NONE","ROTATE","ZOOM","PAN","TOUCH_ROTATE","TOUCH_ZOOM_PAN","enabled","screen","left","top","width","height","rotateSpeed","zoomSpeed","panSpeed","noRotate","noZoom","noPan","staticMoving","dynamicDampingFactor","minDistance","maxDistance","Infinity","keys","mouseButtons","LEFT","MIDDLE","DOLLY","RIGHT","target","EPS","lastPosition","lastZoom","_state","_keyState","_touchZoomDistanceStart","_touchZoomDistanceEnd","_lastAngle","_eye","_movePrev","_moveCurr","_lastAxis","_zoomStart","_zoomEnd","_panStart","_panEnd","target0","clone","position0","position","up0","up","zoom0","zoom","handleResize","box","getBoundingClientRect","d","ownerDocument","documentElement","window","pageXOffset","clientLeft","pageYOffset","clientTop","getMouseOnScreen","vector","pageX","pageY","set","getMouseOnCircle","rotateCamera","axis","quaternion","eyeDirection","objectUpDirection","objectSidewaysDirection","moveDirection","x","y","angle","length","copy","sub","normalize","crossVectors","setLength","add","setFromAxisAngle","applyQuaternion","Math","sqrt","zoomCamera","factor","isPerspectiveCamera","multiplyScalar","isOrthographicCamera","updateProjectionMatrix","panCamera","mouseChange","objectUp","pan","lengthSq","scale_x","right","clientWidth","scale_y","bottom","cross","subVectors","checkDistances","addVectors","update","lookAt","distanceToSquared","dispatchEvent","reset","onPointerDown","event","pointerType","onMouseDown","onPointerMove","onMouseMove","onPointerUp","onMouseUp","keydown","removeEventListener","code","keyup","addEventListener","preventDefault","button","state","mousewheel","deltaMode","deltaY","touchstart","touches","dx","dy","touchmove","touchend","contextmenu","dispose","passive"],"mappings":"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","sourcesContent":["import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tVector2,\n\tVector3\n} from 'three';\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\n\nclass TrackballControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) console.warn( 'THREE.TrackballControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tif ( domElement === document ) console.error( 'THREE.TrackballControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\t\tconst scope = this;\n\t\tconst STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_ZOOM_PAN: 4 };\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\n\t\tthis.screen = { left: 0, top: 0, width: 0, height: 0 };\n\n\t\tthis.rotateSpeed = 1.0;\n\t\tthis.zoomSpeed = 1.2;\n\t\tthis.panSpeed = 0.3;\n\n\t\tthis.noRotate = false;\n\t\tthis.noZoom = false;\n\t\tthis.noPan = false;\n\n\t\tthis.staticMoving = false;\n\t\tthis.dynamicDampingFactor = 0.2;\n\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\tthis.keys = [ 'KeyA' /*A*/, 'KeyS' /*S*/, 'KeyD' /*D*/ ];\n\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// internals\n\n\t\tthis.target = new Vector3();\n\n\t\tconst EPS = 0.000001;\n\n\t\tconst lastPosition = new Vector3();\n\t\tlet lastZoom = 1;\n\n\t\tlet _state = STATE.NONE,\n\t\t\t_keyState = STATE.NONE,\n\n\t\t\t_touchZoomDistanceStart = 0,\n\t\t\t_touchZoomDistanceEnd = 0,\n\n\t\t\t_lastAngle = 0;\n\n\t\tconst _eye = new Vector3(),\n\n\t\t\t_movePrev = new Vector2(),\n\t\t\t_moveCurr = new Vector2(),\n\n\t\t\t_lastAxis = new Vector3(),\n\n\t\t\t_zoomStart = new Vector2(),\n\t\t\t_zoomEnd = new Vector2(),\n\n\t\t\t_panStart = new Vector2(),\n\t\t\t_panEnd = new Vector2();\n\n\t\t// for reset\n\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.up0 = this.object.up.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// methods\n\n\t\tthis.handleResize = function () {\n\n\t\t\tconst box = scope.domElement.getBoundingClientRect();\n\t\t\t// adjustments come from similar code in the jquery offset() function\n\t\t\tconst d = scope.domElement.ownerDocument.documentElement;\n\t\t\tscope.screen.left = box.left + window.pageXOffset - d.clientLeft;\n\t\t\tscope.screen.top = box.top + window.pageYOffset - d.clientTop;\n\t\t\tscope.screen.width = box.width;\n\t\t\tscope.screen.height = box.height;\n\n\t\t};\n\n\t\tconst getMouseOnScreen = ( function () {\n\n\t\t\tconst vector = new Vector2();\n\n\t\t\treturn function getMouseOnScreen( pageX, pageY ) {\n\n\t\t\t\tvector.set(\n\t\t\t\t\t( pageX - scope.screen.left ) / scope.screen.width,\n\t\t\t\t\t( pageY - scope.screen.top ) / scope.screen.height\n\t\t\t\t);\n\n\t\t\t\treturn vector;\n\n\t\t\t};\n\n\t\t}() );\n\n\t\tconst getMouseOnCircle = ( function () {\n\n\t\t\tconst vector = new Vector2();\n\n\t\t\treturn function getMouseOnCircle( pageX, pageY ) {\n\n\t\t\t\tvector.set(\n\t\t\t\t\t( ( pageX - scope.screen.width * 0.5 - scope.screen.left ) / ( scope.screen.width * 0.5 ) ),\n\t\t\t\t\t( ( scope.screen.height + 2 * ( scope.screen.top - pageY ) ) / scope.screen.width ) // screen.width intentional\n\t\t\t\t);\n\n\t\t\t\treturn vector;\n\n\t\t\t};\n\n\t\t}() );\n\n\t\tthis.rotateCamera = ( function () {\n\n\t\t\tconst axis = new Vector3(),\n\t\t\t\tquaternion = new Quaternion(),\n\t\t\t\teyeDirection = new Vector3(),\n\t\t\t\tobjectUpDirection = new Vector3(),\n\t\t\t\tobjectSidewaysDirection = new Vector3(),\n\t\t\t\tmoveDirection = new Vector3();\n\n\t\t\treturn function rotateCamera() {\n\n\t\t\t\tmoveDirection.set( _moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0 );\n\t\t\t\tlet angle = moveDirection.length();\n\n\t\t\t\tif ( angle ) {\n\n\t\t\t\t\t_eye.copy( scope.object.position ).sub( scope.target );\n\n\t\t\t\t\teyeDirection.copy( _eye ).normalize();\n\t\t\t\t\tobjectUpDirection.copy( scope.object.up ).normalize();\n\t\t\t\t\tobjectSidewaysDirection.crossVectors( objectUpDirection, eyeDirection ).normalize();\n\n\t\t\t\t\tobjectUpDirection.setLength( _moveCurr.y - _movePrev.y );\n\t\t\t\t\tobjectSidewaysDirection.setLength( _moveCurr.x - _movePrev.x );\n\n\t\t\t\t\tmoveDirection.copy( objectUpDirection.add( objectSidewaysDirection ) );\n\n\t\t\t\t\taxis.crossVectors( moveDirection, _eye ).normalize();\n\n\t\t\t\t\tangle *= scope.rotateSpeed;\n\t\t\t\t\tquaternion.setFromAxisAngle( axis, angle );\n\n\t\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t\tscope.object.up.applyQuaternion( quaternion );\n\n\t\t\t\t\t_lastAxis.copy( axis );\n\t\t\t\t\t_lastAngle = angle;\n\n\t\t\t\t} else if ( ! scope.staticMoving && _lastAngle ) {\n\n\t\t\t\t\t_lastAngle *= Math.sqrt( 1.0 - scope.dynamicDampingFactor );\n\t\t\t\t\t_eye.copy( scope.object.position ).sub( scope.target );\n\t\t\t\t\tquaternion.setFromAxisAngle( _lastAxis, _lastAngle );\n\t\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t\tscope.object.up.applyQuaternion( quaternion );\n\n\t\t\t\t}\n\n\t\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t\t};\n\n\t\t}() );\n\n\n\t\tthis.zoomCamera = function () {\n\n\t\t\tlet factor;\n\n\t\t\tif ( _state === STATE.TOUCH_ZOOM_PAN ) {\n\n\t\t\t\tfactor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\n\t\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t_eye.multiplyScalar( factor );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\tscope.object.zoom *= factor;\n\t\t\t\t\tscope.object.updateProjectionMatrix();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.TrackballControls: Unsupported camera type' );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfactor = 1.0 + ( _zoomEnd.y - _zoomStart.y ) * scope.zoomSpeed;\n\n\t\t\t\tif ( factor !== 1.0 && factor > 0.0 ) {\n\n\t\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t\t_eye.multiplyScalar( factor );\n\n\t\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t\tscope.object.zoom /= factor;\n\t\t\t\t\t\tscope.object.updateProjectionMatrix();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.TrackballControls: Unsupported camera type' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.staticMoving ) {\n\n\t\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_zoomStart.y += ( _zoomEnd.y - _zoomStart.y ) * this.dynamicDampingFactor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.panCamera = ( function () {\n\n\t\t\tconst mouseChange = new Vector2(),\n\t\t\t\tobjectUp = new Vector3(),\n\t\t\t\tpan = new Vector3();\n\n\t\t\treturn function panCamera() {\n\n\t\t\t\tmouseChange.copy( _panEnd ).sub( _panStart );\n\n\t\t\t\tif ( mouseChange.lengthSq() ) {\n\n\t\t\t\t\tif ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t\tconst scale_x = ( scope.object.right - scope.object.left ) / scope.object.zoom / scope.domElement.clientWidth;\n\t\t\t\t\t\tconst scale_y = ( scope.object.top - scope.object.bottom ) / scope.object.zoom / scope.domElement.clientWidth;\n\n\t\t\t\t\t\tmouseChange.x *= scale_x;\n\t\t\t\t\t\tmouseChange.y *= scale_y;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmouseChange.multiplyScalar( _eye.length() * scope.panSpeed );\n\n\t\t\t\t\tpan.copy( _eye ).cross( scope.object.up ).setLength( mouseChange.x );\n\t\t\t\t\tpan.add( objectUp.copy( scope.object.up ).setLength( mouseChange.y ) );\n\n\t\t\t\t\tscope.object.position.add( pan );\n\t\t\t\t\tscope.target.add( pan );\n\n\t\t\t\t\tif ( scope.staticMoving ) {\n\n\t\t\t\t\t\t_panStart.copy( _panEnd );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_panStart.add( mouseChange.subVectors( _panEnd, _panStart ).multiplyScalar( scope.dynamicDampingFactor ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}() );\n\n\t\tthis.checkDistances = function () {\n\n\t\t\tif ( ! scope.noZoom || ! scope.noPan ) {\n\n\t\t\t\tif ( _eye.lengthSq() > scope.maxDistance * scope.maxDistance ) {\n\n\t\t\t\t\tscope.object.position.addVectors( scope.target, _eye.setLength( scope.maxDistance ) );\n\t\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t\t}\n\n\t\t\t\tif ( _eye.lengthSq() < scope.minDistance * scope.minDistance ) {\n\n\t\t\t\t\tscope.object.position.addVectors( scope.target, _eye.setLength( scope.minDistance ) );\n\t\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.update = function () {\n\n\t\t\t_eye.subVectors( scope.object.position, scope.target );\n\n\t\t\tif ( ! scope.noRotate ) {\n\n\t\t\t\tscope.rotateCamera();\n\n\t\t\t}\n\n\t\t\tif ( ! scope.noZoom ) {\n\n\t\t\t\tscope.zoomCamera();\n\n\t\t\t}\n\n\t\t\tif ( ! scope.noPan ) {\n\n\t\t\t\tscope.panCamera();\n\n\t\t\t}\n\n\t\t\tscope.object.position.addVectors( scope.target, _eye );\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscope.checkDistances();\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( lastPosition.distanceToSquared( scope.object.position ) > EPS ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\n\t\t\t\t}\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( lastPosition.distanceToSquared( scope.object.position ) > EPS || lastZoom !== scope.object.zoom ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastZoom = scope.object.zoom;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.TrackballControls: Unsupported camera type' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\t_state = STATE.NONE;\n\t\t\t_keyState = STATE.NONE;\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.up.copy( scope.up0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\n\t\t\t_eye.subVectors( scope.object.position, scope.target );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tlastPosition.copy( scope.object.position );\n\t\t\tlastZoom = scope.object.zoom;\n\n\t\t};\n\n\t\t// listeners\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( event.pointerType ) {\n\n\t\t\t\tcase 'mouse':\n\t\t\t\tcase 'pen':\n\t\t\t\t\tonMouseDown( event );\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO touch\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( event.pointerType ) {\n\n\t\t\t\tcase 'mouse':\n\t\t\t\tcase 'pen':\n\t\t\t\t\tonMouseMove( event );\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO touch\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( event.pointerType ) {\n\n\t\t\t\tcase 'mouse':\n\t\t\t\tcase 'pen':\n\t\t\t\t\tonMouseUp( event );\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO touch\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction keydown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\twindow.removeEventListener( 'keydown', keydown );\n\n\t\t\tif ( _keyState !== STATE.NONE ) {\n\n\t\t\t\treturn;\n\n\t\t\t} else if ( event.code === scope.keys[ STATE.ROTATE ] && ! scope.noRotate ) {\n\n\t\t\t\t_keyState = STATE.ROTATE;\n\n\t\t\t} else if ( event.code === scope.keys[ STATE.ZOOM ] && ! scope.noZoom ) {\n\n\t\t\t\t_keyState = STATE.ZOOM;\n\n\t\t\t} else if ( event.code === scope.keys[ STATE.PAN ] && ! scope.noPan ) {\n\n\t\t\t\t_keyState = STATE.PAN;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction keyup() {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\t_keyState = STATE.NONE;\n\n\t\t\twindow.addEventListener( 'keydown', keydown );\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( _state === STATE.NONE ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase scope.mouseButtons.LEFT:\n\t\t\t\t\t\t_state = STATE.ROTATE;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase scope.mouseButtons.MIDDLE:\n\t\t\t\t\t\t_state = STATE.ZOOM;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase scope.mouseButtons.RIGHT:\n\t\t\t\t\t\t_state = STATE.PAN;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t_state = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst state = ( _keyState !== STATE.NONE ) ? _keyState : _state;\n\n\t\t\tif ( state === STATE.ROTATE && ! scope.noRotate ) {\n\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t\t} else if ( state === STATE.ZOOM && ! scope.noZoom ) {\n\n\t\t\t\t_zoomStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t\t_zoomEnd.copy( _zoomStart );\n\n\t\t\t} else if ( state === STATE.PAN && ! scope.noPan ) {\n\n\t\t\t\t_panStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t\t_panEnd.copy( _panStart );\n\n\t\t\t}\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tconst state = ( _keyState !== STATE.NONE ) ? _keyState : _state;\n\n\t\t\tif ( state === STATE.ROTATE && ! scope.noRotate ) {\n\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\n\t\t\t} else if ( state === STATE.ZOOM && ! scope.noZoom ) {\n\n\t\t\t\t_zoomEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t\t} else if ( state === STATE.PAN && ! scope.noPan ) {\n\n\t\t\t\t_panEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseUp( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\t_state = STATE.NONE;\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction mousewheel( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tswitch ( event.deltaMode ) {\n\n\t\t\t\tcase 2:\n\t\t\t\t\t// Zoom in pages\n\t\t\t\t\t_zoomStart.y -= event.deltaY * 0.025;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\t\t\t\t\t// Zoom in lines\n\t\t\t\t\t_zoomStart.y -= event.deltaY * 0.01;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// undefined, 0, assume pixels\n\t\t\t\t\t_zoomStart.y -= event.deltaY * 0.00025;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction touchstart( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tswitch ( event.touches.length ) {\n\n\t\t\t\tcase 1:\n\t\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // 2 or more\n\t\t\t\t\t_state = STATE.TOUCH_ZOOM_PAN;\n\t\t\t\t\tconst dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\t\tconst dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t\t_touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\t\tconst x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\t\tconst y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t\t_panStart.copy( getMouseOnScreen( x, y ) );\n\t\t\t\t\t_panEnd.copy( _panStart );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t}\n\n\t\tfunction touchmove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tswitch ( event.touches.length ) {\n\n\t\t\t\tcase 1:\n\t\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // 2 or more\n\t\t\t\t\tconst dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\t\tconst dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t\t_touchZoomDistanceEnd = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\t\tconst x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\t\tconst y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t\t_panEnd.copy( getMouseOnScreen( x, y ) );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction touchend( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( event.touches.length ) {\n\n\t\t\t\tcase 0:\n\t\t\t\t\t_state = STATE.NONE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\t\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction contextmenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', contextmenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'wheel', mousewheel );\n\n\t\t\tscope.domElement.removeEventListener( 'touchstart', touchstart );\n\t\t\tscope.domElement.removeEventListener( 'touchend', touchend );\n\t\t\tscope.domElement.removeEventListener( 'touchmove', touchmove );\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t\twindow.removeEventListener( 'keydown', keydown );\n\t\t\twindow.removeEventListener( 'keyup', keyup );\n\n\t\t};\n\n\t\tthis.domElement.addEventListener( 'contextmenu', contextmenu );\n\n\t\tthis.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tthis.domElement.addEventListener( 'wheel', mousewheel, { passive: false } );\n\n\t\tthis.domElement.addEventListener( 'touchstart', touchstart, { passive: false } );\n\t\tthis.domElement.addEventListener( 'touchend', touchend );\n\t\tthis.domElement.addEventListener( 'touchmove', touchmove, { passive: false } );\n\n\t\tthis.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\n\t\tthis.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\n\n\t\twindow.addEventListener( 'keydown', keydown );\n\t\twindow.addEventListener( 'keyup', keyup );\n\n\t\tthis.handleResize();\n\n\t\t// force an update at start\n\t\tthis.update();\n\n\t}\n\n}\n\nexport { TrackballControls };\n"]},"metadata":{},"sourceType":"module"}