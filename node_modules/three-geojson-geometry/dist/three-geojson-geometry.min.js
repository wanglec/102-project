// Version 1.1.3 three-geojson-geometry - https://github.com/vasturiano/three-geojson-geometry
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).THREE=t.THREE||{},t.THREE)}(this,(function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,n){return(i=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function o(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function u(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=r(t);if(n){var u=r(this).constructor;e=Reflect.construct(i,arguments,u)}else e=i.apply(this,arguments);return o(this,e)}}function f(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==e)return;var r,i,o=[],u=!0,f=!1;try{for(e=e.call(t);!(u=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);u=!0);}catch(t){f=!0,i=t}finally{try{u||null==e.return||e.return()}finally{if(f)throw i}}return o}(t,n)||a(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,n){if(t){if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,n):void 0}}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var l=s,x=s;function s(t,n,e){e=e||2;var r,i,o,u,f,a,c,l=n&&n.length,x=l?n[0]*e:t.length,s=v(t,0,x,e,!0),p=[];if(!s||s.next===s.prev)return p;if(l&&(s=function(t,n,e,r){var i,o,u,f=[];for(i=0,o=n.length;i<o;i++)(u=v(t,n[i]*r,i<o-1?n[i+1]*r:t.length,r,!1))===u.next&&(u.steiner=!0),f.push(E(u));for(f.sort(m),i=0;i<f.length;i++)w(f[i],e),e=h(e,e.next);return e}(t,n,s,e)),t.length>80*e){r=o=t[0],i=u=t[1];for(var d=e;d<x;d+=e)(f=t[d])<r&&(r=f),(a=t[d+1])<i&&(i=a),f>o&&(o=f),a>u&&(u=a);c=0!==(c=Math.max(o-r,u-i))?1/c:0}return y(s,p,e,r,i,c),p}function v(t,n,e,r,i){var o,u;if(i===F(t,n,e,r)>0)for(o=n;o<e;o+=r)u=I(o,t[o],t[o+1],u);else for(o=e-r;o>=n;o-=r)u=I(o,t[o],t[o+1],u);return u&&O(u,u.next)&&(z(u),u=u.next),u}function h(t,n){if(!t)return t;n||(n=t);var e,r=t;do{if(e=!1,r.steiner||!O(r,r.next)&&0!==_(r.prev,r,r.next))r=r.next;else{if(z(r),(r=n=r.prev)===r.next)break;e=!0}}while(e||r!==n);return n}function y(t,n,e,r,i,o,u){if(t){!u&&o&&function(t,n,e,r){var i=t;do{null===i.z&&(i.z=Z(i.x,i.y,n,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var n,e,r,i,o,u,f,a,c=1;do{for(e=t,t=null,o=null,u=0;e;){for(u++,r=e,f=0,n=0;n<c&&(f++,r=r.nextZ);n++);for(a=c;f>0||a>0&&r;)0!==f&&(0===a||!r||e.z<=r.z)?(i=e,e=e.nextZ,f--):(i=r,r=r.nextZ,a--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;e=r}o.nextZ=null,c*=2}while(u>1)}(i)}(t,r,i,o);for(var f,a,c=t;t.prev!==t.next;)if(f=t.prev,a=t.next,o?d(t,r,i,o):p(t))n.push(f.i/e),n.push(t.i/e),n.push(a.i/e),z(t),t=a.next,c=a.next;else if((t=a)===c){u?1===u?y(t=g(h(t),n,e),n,e,r,i,o,2):2===u&&b(t,n,e,r,i,o):y(h(t),n,e,r,i,o,1);break}}}function p(t){var n=t.prev,e=t,r=t.next;if(_(n,e,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(P(n.x,n.y,e.x,e.y,r.x,r.y,i.x,i.y)&&_(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function d(t,n,e,r){var i=t.prev,o=t,u=t.next;if(_(i,o,u)>=0)return!1;for(var f=i.x<o.x?i.x<u.x?i.x:u.x:o.x<u.x?o.x:u.x,a=i.y<o.y?i.y<u.y?i.y:u.y:o.y<u.y?o.y:u.y,c=i.x>o.x?i.x>u.x?i.x:u.x:o.x>u.x?o.x:u.x,l=i.y>o.y?i.y>u.y?i.y:u.y:o.y>u.y?o.y:u.y,x=Z(f,a,n,e,r),s=Z(c,l,n,e,r),v=t.prevZ,h=t.nextZ;v&&v.z>=x&&h&&h.z<=s;){if(v!==t.prev&&v!==t.next&&P(i.x,i.y,o.x,o.y,u.x,u.y,v.x,v.y)&&_(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,h!==t.prev&&h!==t.next&&P(i.x,i.y,o.x,o.y,u.x,u.y,h.x,h.y)&&_(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;v&&v.z>=x;){if(v!==t.prev&&v!==t.next&&P(i.x,i.y,o.x,o.y,u.x,u.y,v.x,v.y)&&_(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;h&&h.z<=s;){if(h!==t.prev&&h!==t.next&&P(i.x,i.y,o.x,o.y,u.x,u.y,h.x,h.y)&&_(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function g(t,n,e){var r=t;do{var i=r.prev,o=r.next.next;!O(i,o)&&A(i,r,r.next,o)&&T(i,o)&&T(o,i)&&(n.push(i.i/e),n.push(r.i/e),n.push(o.i/e),z(r),z(r.next),r=t=o),r=r.next}while(r!==t);return h(r)}function b(t,n,e,r,i,o){var u=t;do{for(var f=u.next.next;f!==u.prev;){if(u.i!==f.i&&S(u,f)){var a=G(u,f);return u=h(u,u.next),a=h(a,a.next),y(u,n,e,r,i,o),void y(a,n,e,r,i,o)}f=f.next}u=u.next}while(u!==t)}function m(t,n){return t.x-n.x}function w(t,n){if(n=function(t,n){var e,r=n,i=t.x,o=t.y,u=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var f=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(f<=i&&f>u){if(u=f,f===i){if(o===r.y)return r;if(o===r.next.y)return r.next}e=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!e)return null;if(i===u)return e;var a,c=e,l=e.x,x=e.y,s=1/0;r=e;do{i>=r.x&&r.x>=l&&i!==r.x&&P(o<x?i:u,o,l,x,o<x?u:i,o,r.x,r.y)&&(a=Math.abs(o-r.y)/(i-r.x),T(r,t)&&(a<s||a===s&&(r.x>e.x||r.x===e.x&&M(e,r)))&&(e=r,s=a)),r=r.next}while(r!==c);return e}(t,n)){var e=G(n,t);h(n,n.next),h(e,e.next)}}function M(t,n){return _(t.prev,t,n.prev)<0&&_(n.next,t,t.next)<0}function Z(t,n,e,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-e)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-r)*i)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function E(t){var n=t,e=t;do{(n.x<e.x||n.x===e.x&&n.y<e.y)&&(e=n),n=n.next}while(n!==t);return e}function P(t,n,e,r,i,o,u,f){return(i-u)*(n-f)-(t-u)*(o-f)>=0&&(t-u)*(r-f)-(e-u)*(n-f)>=0&&(e-u)*(o-f)-(i-u)*(r-f)>=0}function S(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(t,n){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==n.i&&e.next.i!==n.i&&A(e,e.next,t,n))return!0;e=e.next}while(e!==t);return!1}(t,n)&&(T(t,n)&&T(n,t)&&function(t,n){var e=t,r=!1,i=(t.x+n.x)/2,o=(t.y+n.y)/2;do{e.y>o!=e.next.y>o&&e.next.y!==e.y&&i<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next}while(e!==t);return r}(t,n)&&(_(t.prev,t,n.prev)||_(t,n.prev,n))||O(t,n)&&_(t.prev,t,t.next)>0&&_(n.prev,n,n.next)>0)}function _(t,n,e){return(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)}function O(t,n){return t.x===n.x&&t.y===n.y}function A(t,n,e,r){var i=R(_(t,n,e)),o=R(_(t,n,r)),u=R(_(e,r,t)),f=R(_(e,r,n));return i!==o&&u!==f||(!(0!==i||!j(t,e,n))||(!(0!==o||!j(t,r,n))||(!(0!==u||!j(e,t,r))||!(0!==f||!j(e,n,r)))))}function j(t,n,e){return n.x<=Math.max(t.x,e.x)&&n.x>=Math.min(t.x,e.x)&&n.y<=Math.max(t.y,e.y)&&n.y>=Math.min(t.y,e.y)}function R(t){return t>0?1:t<0?-1:0}function T(t,n){return _(t.prev,t,t.next)<0?_(t,n,t.next)>=0&&_(t,t.prev,n)>=0:_(t,n,t.prev)<0||_(t,t.next,n)<0}function G(t,n){var e=new B(t.i,t.x,t.y),r=new B(n.i,n.x,n.y),i=t.next,o=n.prev;return t.next=n,n.prev=t,e.next=i,i.prev=e,r.next=e,e.prev=r,o.next=r,r.prev=o,r}function I(t,n,e,r){var i=new B(t,n,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function z(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function B(t,n,e){this.i=t,this.x=n,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function F(t,n,e,r){for(var i=0,o=n,u=e-r;o<e;o+=r)i+=(t[u]-t[o])*(t[o+1]+t[u+1]),u=o;return i}s.deviation=function(t,n,e,r){var i=n&&n.length,o=i?n[0]*e:t.length,u=Math.abs(F(t,0,o,e));if(i)for(var f=0,a=n.length;f<a;f++){var c=n[f]*e,l=f<a-1?n[f+1]*e:t.length;u-=Math.abs(F(t,c,l,e))}var x=0;for(f=0;f<r.length;f+=3){var s=r[f]*e,v=r[f+1]*e,h=r[f+2]*e;x+=Math.abs((t[s]-t[h])*(t[v+1]-t[s+1])-(t[s]-t[v])*(t[h+1]-t[s+1]))}return 0===u&&0===x?0:Math.abs((x-u)/u)},s.flatten=function(t){for(var n=t[0][0].length,e={vertices:[],holes:[],dimensions:n},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var u=0;u<n;u++)e.vertices.push(t[i][o][u]);i>0&&(r+=t[i-1].length,e.holes.push(r))}return e},l.default=x;class H{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const i=n[r],o=t+i,u=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);u&&(n[e++]=u),t=o}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n,e,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(n=o,e=t[--i],o=n+e,r=e-(o-n),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(e=2*r,n=o+e,e==n-o&&(o=n))}return o}}var L=Math.PI,C=L/2,J=180/L,k=L/180,q=Math.abs,U=Math.atan2,$=Math.cos,D=Math.sin,K=Math.sqrt;function N(t){return(t=D(t/2))*t}function Q(){}function V(t,n){t&&et.hasOwnProperty(t.type)&&et[t.type](t,n)}var W,X,Y,tt,nt={Feature:function(t,n){V(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)V(e[r].geometry,n)}},et={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){rt(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)rt(e[r],n,0)},Polygon:function(t,n){it(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)it(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)V(e[r],n)}};function rt(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function it(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)rt(t[e],n,1);n.polygonEnd()}var ot={sphere:Q,point:Q,lineStart:function(){ot.point=ft,ot.lineEnd=ut},lineEnd:Q,polygonStart:Q,polygonEnd:Q};function ut(){ot.point=ot.lineEnd=Q}function ft(t,n){X=t*=k,Y=D(n*=k),tt=$(n),ot.point=at}function at(t,n){t*=k;var e=D(n*=k),r=$(n),i=q(t-X),o=$(i),u=r*D(i),f=tt*e-Y*r*o,a=Y*e+tt*r*o;W.add(U(K(u*u+f*f),a)),X=t,Y=e,tt=r}function ct(t){return W=new H,function(t,n){t&&nt.hasOwnProperty(t.type)?nt[t.type](t,n):V(t,n)}(t,ot),+W}var lt=[null,null],xt={type:"LineString",coordinates:lt};function st(t,n){return lt[0]=t,lt[1]=n,ct(xt)}function vt(t,n){var e,r=t[0]*k,i=t[1]*k,o=n[0]*k,u=n[1]*k,f=$(i),a=D(i),c=$(u),l=D(u),x=f*$(r),s=f*D(r),v=c*$(o),h=c*D(o),y=2*((e=K(N(u-i)+f*c*N(o-r)))>1?C:e<-1?-C:Math.asin(e)),p=D(y),d=y?function(t){var n=D(t*=y)/p,e=D(y-t)/p,r=e*x+n*v,i=e*s+n*h,o=e*a+n*l;return[U(i,r)*J,U(o,K(r*r+i*i))*J]}:function(){return[r*J,i*J]};return d.distance=y,d}var ht=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=[],r=null;return t.forEach((function(t){if(r){var i=180*st(t,r)/Math.PI;if(i>n)for(var o=vt(r,t),u=1/Math.ceil(i/n),f=u;f<1;)e.push(o(f)),f+=u}e.push(r=t)})),e},yt=window.THREE?window.THREE:{BufferGeometry:n.BufferGeometry,Float32BufferAttribute:n.Float32BufferAttribute},pt=(new yt.BufferGeometry).setAttribute?"setAttribute":"addAttribute",dt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&i(t,n)}(r,t);var n=u(r);function r(t){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;e(this,r),(i=n.call(this)).type="GeoJsonGeometry",i.parameters={geoJson:t,radius:o,resolution:u};var a=({Point:v,MultiPoint:h,LineString:y,MultiLineString:p,Polygon:d,MultiPolygon:g}[t.type]||function(){return[]})(t.coordinates,o),c=[],x=[],s=0;function v(t,n){return[{vertices:mt(t[1],t[0],n),indices:[]}]}function h(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return v(t,n)})).forEach((function(t){var n=f(t,1)[0];gt(e,n)})),[e]}function y(t,n){for(var e=ht(t,u).map((function(t){var e=f(t,2),r=e[0];return mt(e[1],r,n)})),r=l.flatten([e]).vertices,i=Math.round(r.length/3),o=[],a=1;a<i;a++)o.push(a-1,a);return[{vertices:r,indices:o}]}function p(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return y(t,n)})).forEach((function(t){var n=f(t,1)[0];gt(e,n)})),[e]}function d(t,n){for(var e=t.map((function(t){return ht(t,u).map((function(t){var e=f(t,2),r=e[0];return mt(e[1],r,n)}))})),r=l.flatten(e),i=r.vertices,o=r.holes,a=o[0]||1/0,c=i.slice(0,a),x=i.slice(a),s=new Set(o),v=Math.round(i.length/3),h=[],y=[],p=1;p<v;p++)s.has(p)||(p<a?h.push(p-1,p):y.push(p-1-a,p-a));var d=[{indices:h,vertices:c}];return o.length&&d.push({indices:y,vertices:x}),d}function g(t,n){var e={vertices:[],indices:[]},r={vertices:[],indices:[]};t.map((function(t){return d(t,n)})).forEach((function(t){var n=f(t,2),i=n[0],o=n[1];gt(e,i),o&&gt(r,o)}));var i=[e];return r.vertices.length&&i.push(r),i}return a.forEach((function(t){var n=c.length;gt({indices:c,vertices:x},t),i.addGroup(n,c.length-n,s++)})),c.length&&i.setIndex(c),x.length&&i[pt]("position",new yt.Float32BufferAttribute(x,3)),i}return r}(yt.BufferGeometry);function gt(t,n){var e=Math.round(t.vertices.length/3);bt(t.vertices,n.vertices),bt(t.indices,n.indices.map((function(t){return t+e})))}function bt(t,n){var e,r=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=a(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,f=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){f=!0,o=t},f:function(){try{u||null==e.return||e.return()}finally{if(f)throw o}}}}(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push(i)}}catch(t){r.e(t)}finally{r.f()}}function mt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-t)*Math.PI/180,i=(90-n)*Math.PI/180;return[e*Math.sin(r)*Math.cos(i),e*Math.cos(r),e*Math.sin(r)*Math.sin(i)]}t.GeoJsonGeometry=dt,Object.defineProperty(t,"__esModule",{value:!0})}));
